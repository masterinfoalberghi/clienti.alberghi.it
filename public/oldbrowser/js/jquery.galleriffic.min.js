!function(t){var e={},n=0;t.galleriffic={version:"2.0.1",normalizeHash:function(t){return t.replace(/^.*#/,"").replace(/\?.*$/,"")},getImage:function(i){return i?(i=t.galleriffic.normalizeHash(i),e[i]):void 0},gotoImage:function(i){var e=t.galleriffic.getImage(i);if(!e)return!1;var n=e.gallery;return n.gotoImage(e),!0},removeImageByHash:function(i,e){var n=t.galleriffic.getImage(i);if(!n)return!1;var a=n.gallery;return(!e||e==a)&&a.removeImageByIndex(n.index)}};var a={delay:3e3,numThumbs:20,preloadAhead:40,enableTopPager:!1,enableBottomPager:!0,maxPagesToShow:7,imageContainerSel:"",captionContainerSel:"",controlsContainerSel:"",loadingContainerSel:"",renderSSControls:!0,renderNavControls:!0,playLinkText:"Play",pauseLinkText:"Pause",prevLinkText:"Previous",nextLinkText:"Next",nextPageLinkText:"Next &rsaquo;",prevPageLinkText:"&lsaquo; Prev",enableHistory:!1,enableKeyboardNavigation:!0,autoStart:!1,syncTransitions:!1,defaultTransitionDuration:1e3,onSlideChange:void 0,onTransitionOut:void 0,onTransitionIn:void 0,onPageTransitionOut:void 0,onPageTransitionIn:void 0,onImageAdded:void 0,onImageRemoved:void 0};t.fn.galleriffic=function(s){t.extend(this,{version:t.galleriffic.version,isSlideshowRunning:!1,slideshowTimeout:void 0,clickHandler:function(i,e){if(this.pause(),!this.enableHistory){var n=t.galleriffic.normalizeHash(t(e).attr("href"));t.galleriffic.gotoImage(n),i.preventDefault()}},appendImage:function(t){return this.addImage(t,!1,!1),this},insertImage:function(t,i){return this.addImage(t,!1,!0,i),this},addImage:function(i,a,s,r){var o="string"==typeof i?t(i):i,h=o.find("a.thumb"),l=h.attr("href"),d=h.attr("title"),u=o.find(".caption").remove(),c=h.attr("name");n++,(!c||e[""+c])&&(c=n),s||(r=this.data.length);var g={title:d,slideUrl:l,caption:u,hash:c,gallery:this,index:r};s?(this.data.splice(r,0,g),this.updateIndices(r)):this.data.push(g);var m=this;return a||this.updateThumbs(function(){var t=m.find("ul.thumbs");s?t.children(":eq("+r+")").before(o):t.append(o),m.onImageAdded&&m.onImageAdded(g,o)}),e[""+c]=g,h.attr("rel","history").attr("href","#"+c).removeAttr("name").click(function(t){m.clickHandler(t,this)}),this},removeImageByIndex:function(t){if(0>t||t>=this.data.length)return!1;var i=this.data[t];return!!i&&(this.removeImage(i),!0)},removeImageByHash:function(i){return t.galleriffic.removeImageByHash(i,this)},removeImage:function(t){var i=t.index;return this.data.splice(i,1),delete e[""+t.hash],this.updateThumbs(function(){var e=r.find("ul.thumbs").children(":eq("+i+")").remove();r.onImageRemoved&&r.onImageRemoved(t,e)}),this.updateIndices(i),this},updateIndices:function(t){for(i=t;i<this.data.length;i++)this.data[i].index=i;return this},initializeThumbs:function(){this.data=[];var i=this;return this.find("ul.thumbs > li").each(function(e){i.addImage(t(this),!0,!1)}),this},isPreloadComplete:!1,preloadInit:function(){if(0==this.preloadAhead)return this;this.preloadStartIndex=this.currentImage.index;var t=this.getNextIndex(this.preloadStartIndex);return this.preloadRecursive(this.preloadStartIndex,t)},preloadRelocate:function(t){return this.preloadStartIndex=t,this},preloadRecursive:function(t,i){if(t!=this.preloadStartIndex){var e=this.getNextIndex(this.preloadStartIndex);return this.preloadRecursive(this.preloadStartIndex,e)}var n=this,a=i-t;if(0>a&&(a=this.data.length-1-t+i),this.preloadAhead>=0&&a>this.preloadAhead)return setTimeout(function(){n.preloadRecursive(t,i)},500),this;var s=this.data[i];if(!s)return this;if(s.image)return this.preloadNext(t,i);var r=new Image;return r.onload=function(){s.image=this,n.preloadNext(t,i)},r.alt=s.title,r.src=s.slideUrl,this},preloadNext:function(t,i){var e=this.getNextIndex(i);if(e==t)this.isPreloadComplete=!0;else{var n=this;setTimeout(function(){n.preloadRecursive(t,e)},100)}return this},getNextIndex:function(t){var i=t+1;return i>=this.data.length&&(i=0),i},getPrevIndex:function(t){var i=t-1;return 0>i&&(i=this.data.length-1),i},pause:function(){return this.isSlideshowRunning=!1,this.slideshowTimeout&&(clearTimeout(this.slideshowTimeout),this.slideshowTimeout=void 0),this.$controlsContainer&&this.$controlsContainer.find("div.ss-controls a").removeClass().addClass("play").attr("title",this.playLinkText).attr("href","#play").html(this.playLinkText),this},play:function(){if(this.isSlideshowRunning=!0,this.$controlsContainer&&this.$controlsContainer.find("div.ss-controls a").removeClass().addClass("pause").attr("title",this.pauseLinkText).attr("href","#pause").html(this.pauseLinkText),!this.slideshowTimeout){var t=this;this.slideshowTimeout=setTimeout(function(){t.ssAdvance()},this.delay)}return this},toggleSlideshow:function(){return this.isSlideshowRunning?this.pause():this.play(),this},ssAdvance:function(){return this.isSlideshowRunning&&this.next(!0),this},next:function(t,i){return this.gotoIndex(this.getNextIndex(this.currentImage.index),t,i),this},previous:function(t,i){return this.gotoIndex(this.getPrevIndex(this.currentImage.index),t,i),this},nextPage:function(t,i){var e=this.getCurrentPage(),n=this.getNumPages()-1;if(n>e){var a=e*this.numThumbs,s=a+this.numThumbs;this.gotoIndex(s,t,i)}return this},previousPage:function(t,i){var e=this.getCurrentPage();if(e>0){var n=e*this.numThumbs,a=n-this.numThumbs;this.gotoIndex(a,t,i)}return this},gotoIndex:function(i,e,n){e||this.pause(),0>i?i=0:i>=this.data.length&&(i=this.data.length-1);var a=this.data[i];return!n&&this.enableHistory?t.historyLoad(String(a.hash)):this.gotoImage(a),this},gotoImage:function(t){var i=t.index;return this.onSlideChange&&this.onSlideChange(this.currentImage.index,i),this.currentImage=t,this.preloadRelocate(i),this.refresh(),this},getDefaultTransitionDuration:function(t){return t?this.defaultTransitionDuration:this.defaultTransitionDuration/2},refresh:function(){var t=this.currentImage;if(!t)return this;var i=t.index;this.$controlsContainer&&this.$controlsContainer.find("div.nav-controls a.prev").attr("href","#"+this.data[this.getPrevIndex(i)].hash).end().find("div.nav-controls a.next").attr("href","#"+this.data[this.getNextIndex(i)].hash);var e=this.$imageContainer.find("span.current").addClass("previous").removeClass("current"),n=0;this.$captionContainer&&(n=this.$captionContainer.find("span.current").addClass("previous").removeClass("current"));var a=this.syncTransitions&&t.image,s=!0,r=this,o=function(){s=!1,e.remove(),n&&n.remove(),a||(t.image&&t.hash==r.data[r.currentImage.index].hash?r.buildImage(t,a):r.$loadingContainer&&r.$loadingContainer.show())};if(0==e.length?o():this.onTransitionOut?this.onTransitionOut(e,n,a,o):(e.fadeTo(this.getDefaultTransitionDuration(a),0,o),n&&n.fadeTo(this.getDefaultTransitionDuration(a),0)),a&&this.buildImage(t,a),!t.image){var h=new Image;h.onload=function(){t.image=this,s||t.hash!=r.data[r.currentImage.index].hash||r.buildImage(t,a)},h.alt=t.title,h.src=t.slideUrl}return this.relocatePreload=!0,this.syncThumbs()},buildImage:function(t,i){var e=this,n=this.getNextIndex(t.index),a=this.$imageContainer.append('<span class="image-wrapper current"><a class="advance-link" rel="history" href="#'+this.data[n].hash+'" title="'+t.title+'">&nbsp;</a></span>').find("span.current").css("opacity","0");a.find("a").append(t.image).click(function(t){e.clickHandler(t,this)});var s=0;return this.$captionContainer&&(s=this.$captionContainer.append('<span class="image-caption current"></span>').find("span.current").css("opacity","0").append(t.caption)),this.$loadingContainer&&this.$loadingContainer.hide(),this.onTransitionIn?this.onTransitionIn(a,s,i):(a.fadeTo(this.getDefaultTransitionDuration(i),1),s&&s.fadeTo(this.getDefaultTransitionDuration(i),1)),this.isSlideshowRunning&&(this.slideshowTimeout&&clearTimeout(this.slideshowTimeout),this.slideshowTimeout=setTimeout(function(){e.ssAdvance()},this.delay)),this},getCurrentPage:function(){return Math.floor(this.currentImage.index/this.numThumbs)},syncThumbs:function(){var t=this.getCurrentPage();t!=this.displayedPage&&this.updateThumbs();var i=this.find("ul.thumbs").children();return i.filter(".selected").removeClass("selected"),i.eq(this.currentImage.index).addClass("selected"),this},updateThumbs:function(t){var i=this,e=function(){t&&t(),i.rebuildThumbs(),i.onPageTransitionIn?i.onPageTransitionIn():i.show()};return this.onPageTransitionOut?this.onPageTransitionOut(e):(this.hide(),e()),this},rebuildThumbs:function(){var i=this.data.length>this.numThumbs;if(this.enableTopPager){var e=this.find("div.top");0==e.length?e=this.prepend('<div class="top pagination"></div>').find("div.top"):e.empty(),i&&this.buildPager(e)}if(this.enableBottomPager){var n=this.find("div.bottom");0==n.length?n=this.append('<div class="bottom pagination"></div>').find("div.bottom"):n.empty(),i&&this.buildPager(n)}var a=this.getCurrentPage(),s=a*this.numThumbs,r=s+this.numThumbs-1;r>=this.data.length&&(r=this.data.length-1);var o=this.find("ul.thumbs");return o.find("li").each(function(i){var e=t(this);i>=s&&r>=i?e.show():e.hide()}),this.displayedPage=a,o.removeClass("noscript"),this},getNumPages:function(){return Math.ceil(this.data.length/this.numThumbs)},buildPager:function(t){var i=this,e=this.getNumPages(),n=this.getCurrentPage(),a=n*this.numThumbs,s=this.maxPagesToShow-1,r=n-Math.floor((this.maxPagesToShow-1)/2)+1;if(r>0){var o=e-r;s>o&&(r-=s-o)}if(0>r&&(r=0),n>0){var h=a-this.numThumbs;t.append('<a rel="history" href="#'+this.data[h].hash+'" title="'+this.prevPageLinkText+'">'+this.prevPageLinkText+"</a>")}for(r>0&&(this.buildPageLink(t,0,e),r>1&&t.append('<span class="ellipsis">&hellip;</span>'),s--);s>0;)this.buildPageLink(t,r,e),s--,r++;if(e>r){var l=e-1;l>r&&t.append('<span class="ellipsis">&hellip;</span>'),this.buildPageLink(t,l,e)}var d=a+this.numThumbs;return d<this.data.length&&t.append('<a rel="history" href="#'+this.data[d].hash+'" title="'+this.nextPageLinkText+'">'+this.nextPageLinkText+"</a>"),t.find("a").click(function(t){i.clickHandler(t,this)}),this},buildPageLink:function(t,i,e){var n=i+1,a=this.getCurrentPage();if(i==a)t.append('<span class="current">'+n+"</span>");else if(e>i){var s=i*this.numThumbs;t.append('<a rel="history" href="#'+this.data[s].hash+'" title="'+n+'">'+n+"</a>")}return this}}),t.extend(this,a,s),this.enableHistory&&!t.historyInit&&(this.enableHistory=!1),this.imageContainerSel&&(this.$imageContainer=t(this.imageContainerSel)),this.captionContainerSel&&(this.$captionContainer=t(this.captionContainerSel)),this.loadingContainerSel&&(this.$loadingContainer=t(this.loadingContainerSel)),this.initializeThumbs(),this.maxPagesToShow<3&&(this.maxPagesToShow=3),this.displayedPage=-1,this.currentImage=this.data[0];var r=this;this.$loadingContainer&&this.$loadingContainer.hide(),this.controlsContainerSel&&(this.$controlsContainer=t(this.controlsContainerSel).empty(),this.renderSSControls&&(this.autoStart?this.$controlsContainer.append('<div class="ss-controls"><a href="#pause" class="pause" title="'+this.pauseLinkText+'">'+this.pauseLinkText+"</a></div>"):this.$controlsContainer.append('<div class="ss-controls"><a href="#play" class="play" title="'+this.playLinkText+'">'+this.playLinkText+"</a></div>"),this.$controlsContainer.find("div.ss-controls a").click(function(t){return r.toggleSlideshow(),t.preventDefault(),!1})),this.renderNavControls&&this.$controlsContainer.append('<div class="nav-controls"><a class="prev" rel="history">'+this.prevLinkText+'"></a><a class="next" rel="history">'+this.nextLinkText+'"></a></div>').find("div.nav-controls a").click(function(t){r.clickHandler(t,this)}));var o=!this.enableHistory||!location.hash;if(this.enableHistory&&location.hash){var h=t.galleriffic.normalizeHash(location.hash),l=e[h];l||(o=!0)}return o&&this.gotoIndex(0,!1,!0),this.enableKeyboardNavigation&&t(document).keydown(function(t){t.charCode?t.charCode:t.keyCode?t.keyCode:0}),this.autoStart&&this.play(),setTimeout(function(){r.preloadInit()},1e3),this}}(jQuery);