jQuery.fn.editable=function(e,t,i){if(0===this.length)return this;var n={target:e,name:"value",id:"id",type:"text",width:"auto",height:"auto",event:"click",onblur:"cancel",loadtype:"GET",loadtext:"Loading...",loaddata:{},submitdata:{}};t&&jQuery.extend(n,t);var a=jQuery.editable.types[n.type].plugin||function(){},r=jQuery.editable.types[n.type].submit||function(){},u=jQuery.editable.types[n.type].buttons||jQuery.editable.types.defaults.buttons,l=jQuery.editable.types[n.type].content||jQuery.editable.types.defaults.content,s=jQuery.editable.types[n.type].element||jQuery.editable.types.defaults.element;return i=i||function(){},jQuery(this).attr("title",n.tooltip),n.autowidth="auto"==n.width,n.autoheight="auto"==n.height,jQuery(this)[n.event](function(e){function t(){y.innerHTML=y.revert,y.editing=!1}var y=this;if(!y.editing){"none"!=n.width&&(n.width=n.autowidth?jQuery(y).width():n.width),"none"!=n.height&&(n.height=n.autoheight?jQuery(y).height():n.height),y.editing=!0,y.revert=jQuery(y).html(),y.innerHTML="";var o=document.createElement("form");n.cssclass&&("inherit"==n.cssclass?jQuery(o).attr("class",jQuery(y).attr("class")):jQuery(o).attr("class",n.cssclass)),n.style&&("inherit"==n.style?(jQuery(o).attr("style",jQuery(y).attr("style")),jQuery(o).css("display",jQuery(y).css("display"))):jQuery(o).attr("style",n.style));var d=s.apply(o,[n,y]);if(n.getload?(n.loadurl=n.getload,n.loadtype="GET"):n.postload&&(n.loadurl=n.postload,n.loadtype="POST"),n.loadurl){var p=setTimeout(function(){d.disabled=!0,l.apply(o,[n.loadtext,n,y])},100),c={};c[n.id]=y.id,jQuery.isFunction(n.loaddata)?jQuery.extend(c,n.loaddata.apply(y,[y.revert,n])):jQuery.extend(c,n.loaddata),jQuery.ajax({type:n.loadtype,url:n.loadurl,data:c,success:function(e){window.clearTimeout(p),l.apply(o,[e,n,y]),d.disabled=!1}})}else if(n.data){var j=n.data;if(jQuery.isFunction(n.data))var j=n.data.apply(y,[y.revert,n]);l.apply(o,[j,n,y])}else l.apply(o,[y.revert,n,y]);d.name=n.name,u.apply(o,[n,y]),y.appendChild(o),n.select&&d.select(),a.apply(o,[n,y]),jQuery(":input:visible:enabled:first",o).focus(),jQuery(d).keydown(function(e){27==e.keyCode&&(e.preventDefault(),t())});var p;"cancel"==n.onblur?jQuery(d).blur(function(e){p=setTimeout(t,500)}):"submit"==n.onblur?jQuery(d).blur(function(e){jQuery(o).submit()}):jQuery(d).blur(function(e){}),jQuery(o).submit(function(e){if(p&&clearTimeout(p),e.preventDefault(),r.apply(o,[n,y]),jQuery.isFunction(n.target)){var t=n.target.apply(y,[jQuery(d).val(),n]);y.innerHTML=t,y.editing=!1,i.apply(y,[y.innerHTML,n])}else{var a={};a[d.name]=jQuery(d).val(),a[n.id]=y.id,jQuery.isFunction(n.submitdata)?jQuery.extend(a,n.submitdata.apply(y,[y.revert,n])):jQuery.extend(a,n.submitdata),jQuery(y).html(n.indicator),jQuery.post(n.target,a,function(e){y.innerHTML=e,y.editing=!1,i.apply(y,[y.innerHTML,n])})}return!1})}}),this},jQuery.editable={types:{defaults:{element:function(e,t){var i=jQuery('<input type="hidden">');return jQuery(this).append(i),i},content:function(e,t,i){jQuery(":input:first",this).val(e)},buttons:function(e,t){if(e.submit){var i=jQuery('<input type="submit">');i.val(e.submit),jQuery(this).append(i)}if(e.cancel){var n=jQuery('<input type="button">');n.val(e.cancel),jQuery(this).append(n),jQuery(n).click(function(){jQuery(t).html(t.revert),t.editing=!1})}}},text:{element:function(e,t){var i=jQuery("<input>");return"none"!=e.width&&i.width(e.width),"none"!=e.height&&i.height(e.height),i.attr("autocomplete","off"),jQuery(this).append(i),i}},textarea:{element:function(e,t){var i=jQuery("<textarea>");return e.rows?i.attr("rows",e.rows):i.height(e.height),e.cols?i.attr("cols",e.cols):i.width(e.width),jQuery(this).append(i),i}},select:{element:function(e,t){var i=jQuery("<select>");return jQuery(this).append(i),i},content:function(string,settings,original){var select=jQuery("select",this);if(String==string.constructor){eval("var json = "+string);for(var key in json)if("selected"!=key){var option=$("<option>").val(key).append(json[key]);select.append(option)}}jQuery.editable.types.select.iefix(select,json.selected)},iefix:function(e,t){console.log(this),console.log(e),e.children().each(function(){jQuery(this).val()==t&&jQuery(this).attr("selected","selected")})}}},addInputType:function(e,t){jQuery.editable.types[e]=t}};