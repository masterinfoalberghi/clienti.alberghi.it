!function(e){var t=function(t,a){this.element=e(t);var s=this.element.closest(".room").attr("id"),i=".daterange";if(void 0!=s&&(i="#"+s+" .daterange"),this.format=e.fn.datepicker.DPGlobal.parseFormat(a.format||this.element.data("date-format")||"dd/mm/yyyy"),this.picker=e(e.fn.datepicker.DPGlobal.template).appendTo(i).on({click:e.proxy(this.click,this)}),this.isInput=this.element.is("input"),this.component=!!this.element.is(".date")&&this.element.find(".add-on"),this.isInput?this.element.on({focus:e.proxy(this.show,this),keyup:e.proxy(this.update,this)}):this.component?this.component.on("click",e.proxy(this.show,this)):this.element.on("click",e.proxy(this.show,this)),this.minViewMode=a.minViewMode||this.element.data("date-minviewmode")||0,"string"==typeof this.minViewMode)switch(this.minViewMode){case"months":this.minViewMode=1;break;case"years":this.minViewMode=2;break;default:this.minViewMode=0}if(this.viewMode=a.viewMode||this.element.data("date-viewmode")||0,"string"==typeof this.viewMode)switch(this.viewMode){case"months":this.viewMode=1;break;case"years":this.viewMode=2;break;default:this.viewMode=0}a.language=a.language?a.language:"en",this.options=a,this.startViewMode=this.viewMode,this.weekStart=a.weekStart||this.element.data("date-weekstart")||0,this.weekEnd=0===this.weekStart?6:this.weekStart-1,this.onRender=a.onRender,this.fillDow(),this.fillMonths(),this.update(),this.showMode()};t.prototype={constructor:t,language:function(){},show:function(t){this.picker.show(),this.height=this.component?this.component.outerHeight():this.element.outerHeight(),this.place(),e(window).on("resize",e.proxy(this.place,this)),t&&(t.stopPropagation(),t.preventDefault()),this.isInput;var a=this;e(document).on("mousedown",function(t){0==e(t.target).closest(".datepicker").length&&a.hide()}),this.element.trigger({type:"show",date:this.date})},hide:function(){e(".arrivo_button").removeClass("selected"),e(".partenza_button").removeClass("selected"),e("#a_partire_da_button").removeClass("selected"),e(".data_picker").removeClass("opacity"),e(".date_info").show(),this.picker.hide(),e(window).off("resize",this.place),this.viewMode=this.startViewMode,this.showMode(),this.isInput||e(document).off("mousedown",this.hide),this.element.trigger({type:"hide",date:this.date})},set:function(){var t=e.fn.datepicker.DPGlobal.formatDate(this.date,this.format);this.isInput?this.element.prop("value",t):(this.component&&this.element.find("input").prop("value",t),this.element.data("date",t))},setValue:function(t){this.date="string"==typeof t?e.fn.datepicker.DPGlobal.parseDate(t,this.format):new Date(t),this.set(),this.viewDate=new Date(this.date.getFullYear(),this.date.getMonth(),1,0,0,0,0),this.fill()},place:function(){var e=this.component?this.component.offset():this.element.offset();this.picker.css({top:e.top+this.height,left:e.left})},update:function(t){this.date=e.fn.datepicker.DPGlobal.parseDate("string"==typeof t?t:this.isInput?this.element.prop("value"):this.element.data("date"),this.format),this.viewDate=new Date(this.date.getFullYear(),this.date.getMonth(),1,0,0,0,0),this.fill()},fillDow:function(){for(var t=this.weekStart,a="<tr>";t<this.weekStart+7;)a+='<th class="dow">'+e.fn.datepicker.DPGlobal.dates[this.options.language].daysMin[t++%7]+"</th>";a+="</tr>",this.picker.find(".datepicker-days thead").append(a)},fillMonths:function(){for(var t="",a=0;a<12;)t+='<span class="month">'+e.fn.datepicker.DPGlobal.dates[this.options.language].monthsShort[a++]+"</span>";this.picker.find(".datepicker-months td").append(t)},fill:function(){var t=new Date(this.viewDate),a=t.getFullYear(),s=t.getMonth(),i=this.date.valueOf();this.picker.find(".datepicker-days th:eq(1)").text(e.fn.datepicker.DPGlobal.dates[this.options.language].months[s]+" "+a);var n=new Date(a,s-1,28,0,0,0,0),o=e.fn.datepicker.DPGlobal.getDaysInMonth(n.getFullYear(),n.getMonth());n.setDate(o),n.setDate(o-(n.getDay()-this.weekStart+7)%7);var r=new Date(n);r.setDate(r.getDate()+42),r=r.valueOf();for(var d,h,l,c=[];n.valueOf()<r;){n.getDay()===this.weekStart&&c.push("<tr>"),d=this.onRender(n),h=n.getFullYear(),l=n.getMonth(),l<s&&h===a||h<a?d+=" old":(l>s&&h===a||h>a)&&(d+=" new"),n.valueOf()===i&&(d+=" active");var p=this.element.closest(".room").attr("id");if(void 0!=p){var u=e("#"+p+" .arrivo").val(),f=e("#"+p+" .partenza").val();u=u.substr(3,2)+"/"+u.substr(0,2)+"/"+u.substr(6,4),f=f.substr(3,2)+"/"+f.substr(0,2)+"/"+f.substr(6,4),u=new Date(u),f=new Date(f),n.valueOf()>=u.getTime()&&n.valueOf()<=f.getTime()&&(d+=" selected")}c.push('<td class="day '+d+'">'+n.getDate()+"</td>"),n.getDay()===this.weekEnd&&c.push("</tr>"),n.setDate(n.getDate()+1)}this.picker.find(".datepicker-days tbody").empty().append(c.join(""));var m=this.date.getFullYear(),v=this.picker.find(".datepicker-months").find("th:eq(1)").text(a).end().find("span").removeClass("active");m===a&&v.eq(this.date.getMonth()).addClass("active"),c="",a=10*parseInt(a/10,10);var w=this.picker.find(".datepicker-years").find("th:eq(1)").text(a+"-"+(a+9)).end().find("td");a-=1;for(var g=-1;g<11;g++)c+='<span class="year'+(-1===g||10===g?" old":"")+(m===a?" active":"")+'">'+a+"</span>",a+=1;w.html(c)},click:function(t){t.stopPropagation(),t.preventDefault();var a=e(t.target).closest("span, td, th");if(1===a.length)switch(a[0].nodeName.toLowerCase()){case"th":switch(a[0].className){case"switch":this.showMode(1);break;case"prev":case"next":this.viewDate["set"+e.fn.datepicker.DPGlobal.modes[this.viewMode].navFnc].call(this.viewDate,this.viewDate["get"+e.fn.datepicker.DPGlobal.modes[this.viewMode].navFnc].call(this.viewDate)+e.fn.datepicker.DPGlobal.modes[this.viewMode].navStep*("prev"===a[0].className?-1:1)),this.fill(),this.set()}break;case"span":if(a.is(".month")){var s=a.parent().find("span").index(a);this.viewDate.setMonth(s)}else{var i=parseInt(a.text(),10)||0;this.viewDate.setFullYear(i)}0!==this.viewMode&&(this.date=new Date(this.viewDate),this.element.trigger({type:"changeDate",date:this.date,viewMode:e.fn.datepicker.DPGlobal.modes[this.viewMode].clsName})),this.showMode(-1),this.fill(),this.set();break;case"td":if(a.is(".day")&&!a.is(".disabled")){var n=parseInt(a.text(),10)||1,s=this.viewDate.getMonth();a.is(".old")?s-=1:a.is(".new")&&(s+=1);var i=this.viewDate.getFullYear();this.date=new Date(i,s,n,0,0,0,0),this.viewDate=new Date(i,s,Math.min(28,n),0,0,0,0),this.fill(),this.set(),this.element.trigger({type:"changeDate",date:this.date,viewMode:e.fn.datepicker.DPGlobal.modes[this.viewMode].clsName})}}},mousedown:function(e){e.stopPropagation(),e.preventDefault()},showMode:function(t){t&&(this.viewMode=Math.max(this.minViewMode,Math.min(2,this.viewMode+t))),this.picker.find(">div").hide().filter(".datepicker-"+e.fn.datepicker.DPGlobal.modes[this.viewMode].clsName).show()}},e.fn.datepicker=function(a,s){return this.each(function(){var i=e(this),n=i.data("datepicker"),o="object"==typeof a&&a;n||i.data("datepicker",n=new t(this,e.extend({},e.fn.datepicker.defaults,o))),"string"==typeof a&&n[a](s)})},e.fn.datepicker.defaults={onRender:function(e){return""}},e.fn.datepicker.Constructor=t,e.fn.datepicker.DPGlobal={modes:[{clsName:"days",navFnc:"Month",navStep:1},{clsName:"months",navFnc:"FullYear",navStep:1},{clsName:"years",navFnc:"FullYear",navStep:10}],dates:{en:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa","Su"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}},isLeapYear:function(e){return e%4==0&&e%100!=0||e%400==0},getDaysInMonth:function(t,a){return[31,e.fn.datepicker.DPGlobal.isLeapYear(t)?29:28,31,30,31,30,31,31,30,31,30,31][a]},parseFormat:function(e){var t=e.match(/[.\/\-\s].*?/),a=e.split(/\W+/);if(!t||!a||0===a.length)throw new Error("Invalid date format.");return{separator:t,parts:a}},parseDate:function(e,t){var a,s=e.split(t.separator),e=new Date;if(e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),s.length===t.parts.length){for(var i=e.getFullYear(),n=e.getDate(),o=e.getMonth(),r=0,d=t.parts.length;r<d;r++)switch(a=parseInt(s[r],10)||1,t.parts[r]){case"dd":case"d":n=a,e.setDate(a);break;case"mm":case"m":o=a-1,e.setMonth(a-1);break;case"yy":i=2e3+a,e.setFullYear(2e3+a);break;case"yyyy":i=a,e.setFullYear(a)}e=new Date(i,o,n,0,0,0)}return e},formatDate:function(e,t){var a={d:e.getDate(),m:e.getMonth()+1,yy:e.getFullYear().toString().substring(2),yyyy:e.getFullYear()};a.dd=(a.d<10?"0":"")+a.d,a.mm=(a.m<10?"0":"")+a.m;for(var e=[],s=0,i=t.parts.length;s<i;s++)e.push(a[t.parts[s]]);return e.join(t.separator)},headTemplate:'<thead><tr><th class="prev">&lsaquo;</th><th colspan="5" class="switch"></th><th class="next">&rsaquo;</th></tr></thead>',contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>'},e.fn.datepicker.DPGlobal.template='<div class="datepicker dropdown-menu"><div class="datepicker-days"><table class=" table-condensed">'+e.fn.datepicker.DPGlobal.headTemplate+'<tbody></tbody></table></div><div class="datepicker-months"><table class="table-condensed">'+e.fn.datepicker.DPGlobal.headTemplate+e.fn.datepicker.DPGlobal.contTemplate+'</table></div><div class="datepicker-years"><table class="table-condensed">'+e.fn.datepicker.DPGlobal.headTemplate+e.fn.datepicker.DPGlobal.contTemplate+"</table></div></div>"}(window.jQuery);